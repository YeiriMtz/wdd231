// minimized ViewTransition, according to my lighthouse test
const apiKey="694f3d563d3489dfbfc9bcb22b0cc292",weatherLocation=document.getElementById("weather-location"),weatherDescription=document.getElementById("weather-description"),weatherTemp=document.getElementById("weather-temp"),weatherHighLow=document.getElementById("weather-high-low"),weatherHumidity=document.getElementById("weather-humidity"),weatherSunrise=document.getElementById("weather-sunrise"),weatherSunset=document.getElementById("weather-sunset"),weatherIcon=document.getElementById("weather-icon"),forecastToday=document.getElementById("forecast-today"),forecastWed=document.getElementById("forecast-wed"),forecastThu=document.getElementById("forecast-thu");function formatTime(t,e){let n=new Date((t+e)*1e3);return n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function getWeatherByCoords(t,e){let n=`https://api.openweathermap.org/data/2.5/weather?lat=${t}&lon=${e}&appid=${apiKey}&units=metric`;fetch(n).then(t=>{if(!t.ok)throw Error("Weather fetch failed");return t.json()}).then(t=>{let{name:e,sys:n,main:o,weather:r,timezone:a}=t,i=r[0].icon,s=`https://openweathermap.org/img/wn/${i}@2x.png`;weatherLocation.textContent=`${e}, ${n.country}`;let c=r[0].description;weatherDescription.textContent=c.charAt(0).toUpperCase()+c.slice(1),weatherTemp.textContent=`${o.temp} \xb0C`,weatherHighLow.innerHTML=`<strong>High:</strong> ${o.temp_max} \xb0C / <strong>Low:</strong> ${o.temp_min} \xb0C`,weatherHumidity.innerHTML=`<strong>Humidity:</strong> ${o.humidity}%`,weatherSunrise.innerHTML=`<strong>Sunrise:</strong> ${formatTime(n.sunrise,a)}`,weatherSunset.innerHTML=`<strong>Sunset:</strong> ${formatTime(n.sunset,a)}`,weatherIcon.src=s,weatherIcon.alt=r[0].description,weatherIcon.style.display="inline"}).catch(t=>{console.error(t),weatherLocation.textContent="Unable to get weather data"})}function getForecastByCoords(t,e){let n=`https://api.openweathermap.org/data/2.5/forecast?lat=${t}&lon=${e}&appid=${apiKey}&units=metric`;fetch(n).then(t=>{if(!t.ok)throw Error("Forecast fetch failed");return t.json()}).then(t=>{let e=t.list,n=new Date,o=new Date(n),r=new Date(n);o.setDate(n.getDate()+((10-n.getDay())%7||7)),r.setDate(n.getDate()+((11-n.getDay())%7||7));let a=n.toISOString().split("T")[0],i=o.toISOString().split("T")[0],s=r.toISOString().split("T")[0],c=t=>e.find(e=>e.dt_txt.startsWith(t)&&e.dt_txt.includes("12:00:00")),h=(t,e,n)=>{if(!e){t.textContent=`${n}: No data`;return}t.innerHTML=`<strong>${n}:</strong> ${e.main.temp} \xb0C`};h(forecastToday,c(a),"Today"),h(forecastWed,c(i),"Next Wednesday"),h(forecastThu,c(s),"Next Thursday")}).catch(t=>{console.error(t),forecastToday.textContent="Forecast unavailable",forecastWed.textContent="",forecastThu.textContent=""})}function getUserLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{let e=t.coords.latitude,n=t.coords.longitude;getWeatherByCoords(e,n),getForecastByCoords(e,n)},t=>{console.error(t),weatherLocation.textContent="Location access denied"}):weatherLocation.textContent="Geolocation not supported"}getUserLocation();